---
# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘                    âš¡ï¸âœ¨ SAILOR JUPITER SYSTEM CONFIG âœ¨âš¡ï¸                  â•‘
# â•‘                                                                            â•‘
# â•‘                         Protected by Jupiter                               â•‘
# â•‘                      Guardian of Thunder & Courage                         â•‘
# â•‘                                                                            â•‘
# â•‘                          æœ¨é‡ ã¾ã“ã¨ (Makoto Kino)                         â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

- hosts: all
  user: root
  gather_facts: no
  vars:
    username: hexgnu
    hostname: jupiter.home
    email: matt@matthewkirk.com
    ansible_python_interpreter: /usr/bin/python3
    ssh_keygen_bits: 4096
    ssh_keygen_types:
      - ed25519
    fedora_version: 39
  
  pre_tasks:
    - name: "âš¡ Sailor Jupiter Power Make Up! âš¡"
      shell: |
        echo ""
        echo "        âœ¨âš¡ğŸŒ¸ TRANSFORMATION SEQUENCE INITIATED ğŸŒ¸âš¡âœ¨"
        echo ""
        echo "              'Jupiter Star Power, Make Up!'"
        echo ""
        python3 {{ playbook_dir }}/sailor_jupiter_banner.py 2>/dev/null || true
        echo ""
        echo "        System configuration transformation beginning..."
        echo ""
      delegate_to: localhost
      run_once: true
      tags: always

  roles:
    - keys
    # - i3blocks
    - flatpak
    - st
    - vim
    - pyenv
    - nvm
    - podman
    - developer-tools
    - slack
    - nvidia
  become_method: sudo
  become: true
  
  tasks:  
    - hostname:
        name: jupiter.home

    # Someday revisit to implement better security for this.
    - service:
        name: sshd
        state: started

    - name: Install RPMFusion free
      tags: [personal]
      dnf:
        name: "https://mirrors.rpmfusion.org/free/fedora/rpmfusion-free-release-{{ fedora_version }}.noarch.rpm"
        disable_gpg_check: yes
        state: present

    - name: Install RPMFusion non free
      tags: [personal]
      dnf:
        disable_gpg_check: yes
        name: "https://mirrors.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-{{ fedora_version }}.noarch.rpm"
        state: present

  post_tasks:
    - name: "âœ¨ Transformation Complete! âœ¨"
      shell: |
        echo ""
        echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
        echo "    ğŸŒ¸ 'In the name of Jupiter, I'll punish you!' ğŸŒ¸"
        echo ""
        echo "         System {{ hostname }} configured successfully!"
        echo "              Protected by Sailor Jupiter âš¡"
        echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
        echo ""
      delegate_to: localhost
      run_once: true
      tags: always
